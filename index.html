<!DOCTYPE html PUBLIC "-//WC3//DTD XHTML 1.0 Strict//EN"

	http://www.w3.org/TR/xhmtl1/DTS/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

	<head>

		<title>STACK Ad Server</title>

		  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

		  <meta name="viewport" content="width=device-width, initial-scale=1">

		  <style>
		  	#viddy {
		  		/* background: pink; */
		  	}
		  	#wally {
		  		cursor: pointer;
		  	}
		  </style>
	</head>

	<body> 
			<script language="javascript" type="text/javascript">
			</script>
			<noscript>
				<h3>Sorry...you need javascript</h3>
			</noscript>

	<div id="viddy">
		<h3>Local Ad of the Day - REMOTE</h3>

		<video id="wally" width="320" height="240" autoplay><source id="thesource" src="" type="video/mp4"></video><br/>
		ID: <span class="id">Time to Chime</span><br/>
		AdId: <span class="adId">adid</span><br/>
		AdUnit: <span class="adUnit">adUnit</span><br/>
		Location: <span class="location">viddy</span>
	</div>

</body>
<script>
 $(document).ready(function () {
 	var viddy;
						
				$.ajax({
				        type: 'GET',
				        //url: 'http://localhost:8081/test?callback=jsonpCallback',
				        url: 'http://adserver-env-poly.elasticbeanstalk.com/test?callback=jsonpCallback',
				        crossDomain: true,
				        async: false,
				        jsonpCallback: 'jsonpCallback',
				        dataType: 'jsonp',
				        jsonp: false,
				        contentType:'application/json',
				        success: function(data) {  

				        	console.log("received new data: " , data );      
	
					         viddy = data.url;
					         adid = data.adId;
					         adUnit = data.adUnit;

					         console.log("Our Viddy: " + viddy );

						    $('#thesource').attr('src',viddy );

						    var player = document.getElementById('wally'); 
						        player.load(); 

						$(".adId").text(adid);
						$(".adUnit").text(adUnit);
						$(".location").text(viddy);

				        }
				    });


		 function jsonpCallback(json) {
		        if (!json.Error) {
		           console.log('Json Data from endpoint: ' , json );
		        }
		        else {
		            alert(json.Message);
		        }
		    }//end Jsonp Callback


		    // onClick I want something exciting to happen

		    $( "#wally" ).click(function() {
  				alert( "Handler for .click() called." );
				});

 });
</script>
</html>

